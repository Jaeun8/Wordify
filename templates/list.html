<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WORDIFY 나의 단어장</title>
  <link rel="stylesheet" href="../static/list.css" />
</head>
<body>

<header>

  <form action="{{ url_for('home') }}">
    <button class="logo" type="submit">WORD<span>IFY</span></button>
  </form>
  
  <nav>
    <ul>
      <li>
        <form action="{{ url_for('streaks_page') }}">
          <button class="nav-btn streaks">Streaks</button>
        </form>
      </li>
      <li>
        <form action="{{ url_for('playlist') }}">
          <button class="nav-btn streaks">Playlist</button>
        </form>
      </li>
      
      <li>
        <div class="dropdown">
          <button class="dropbtn"> 
            <span class="dropbtn_icon">menu</span>
          </button>
          <div class="dropdown-content">
            <form action="{{ url_for('my_flashcard') }}">
              <button  class="flashcard flashcard-btn">flashcard</button>
            </form>
            <form action="{{ url_for('quiz') }}">
              <button  class="quiz-btn quiz">quiz</button>
            </form>
            <form action="{{ url_for('word_list') }}">
              <button  class="list-btn ">my lists</button>
            </form>
            <li>
              {% if current_user is defined and current_user.is_authenticated %}
              <form action="{{ url_for('logout') }}">
                  <button class="nav-btn">Logout</button>
              </form>
              {% else %}
              <form action="{{ url_for('login') }}">
                <button class="nav-btn">Login/Signup</button>
              </form>
              {% endif %}
            </li>
          </div>
        </div>
      </li>
    </ul>

  </nav>
</header>
<h1> 나의단어장 </h1>


  {% if word_list %}
    <div class="delete-section">
      <form method="POST" action="{{ url_for('delete_all_words') }}">
        <button class="delete-btn" type="submit">리스트 전체 삭제</button>
      </form>
    </div>
    <main style="display: flex; gap: 20px; padding: 20px;">

    <div id="list-buttons-container" >
      <!-- JS가 버튼 동적으로 추가 -->
    </div>
  
    <!-- 오른쪽: 단어 리스트 표시 -->
    <div id="word-list" >
      <!-- 선택된 리스트 단어들 출력 -->
    </div>


  {% else %}
    <p style="text-align:center;">저장된 단어가 없습니다.</p>
  {% endif %}
    <form action="{{ url_for('quiz') }}" style="display: inline-block; margin-right: 20px;">
      <button type="submit" class="quiz-go-btn">퀴즈 보기</button>
    </form>
    
    <form action="{{ url_for('my_flashcard') }}" style="display: inline-block;">
      <button id="flashcard-go-btn" class="flashcard-go-btn" style="display:inline-block;">Flashcard 가기</button>
    </form>
</main>


<script>
  const words = JSON.parse('{{ word_list | tojson | safe }}');
const buttonsContainer = document.getElementById('list-buttons-container');
const wordListDiv = document.getElementById('word-list');
const wordsPerList = 10;
let currentListIndex = 1; // 현재 보고있는 리스트 번호

function showListWords(listIndex) {
  currentListIndex = listIndex;

  const start = (listIndex - 1) * wordsPerList;
  const end = start + wordsPerList;
  const currentList = words.slice(start, end);

  // 단어 출력
  wordListDiv.innerHTML = `<h2>List ${listIndex}</h2>`;
  const ul = document.createElement('ul');

  currentList.forEach(item => {
    const li = document.createElement('li');
    li.innerHTML = `<strong>${item.word}</strong>: ${item.meaning}`;
    ul.appendChild(li);
  });

  wordListDiv.appendChild(ul);

  // 버튼 active 상태 처리
  const allButtons = document.querySelectorAll('.list-button');
  allButtons.forEach(btn => btn.classList.remove('active'));
  allButtons[listIndex - 1].classList.add('active');

  // hidden input에 현재 리스트 단어 JSON 저장
  const hiddenInput = document.getElementById('words_data');
  if(hiddenInput) {
    hiddenInput.value = JSON.stringify(currentList);
  }
}

// 버튼 생성 및 초기 표시
if (words.length > 0) {
  const numOfLists = Math.ceil(words.length / wordsPerList);

  for (let i = 1; i <= numOfLists; i++) {
    const btn = document.createElement('button');
    btn.className = 'list-button';
    btn.textContent = `List ${i}`;
    btn.addEventListener('click', () => showListWords(i));
    buttonsContainer.appendChild(btn);
  }

  showListWords(1);
} else {
  buttonsContainer.innerHTML = '<p>저장된 리스트가 없습니다.</p>';
  wordListDiv.innerHTML = '';
}

btn.className = 'list-button';


</script>



</body>
</html>
  